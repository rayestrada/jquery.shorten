!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(e,s,t,n){e.fn.shorten=function(s){"use strict";var n={showChars:100,minHideChars:10,ellipsesText:"...",moreText:"more",lessText:"less",onLess:function(){},onMore:function(){},errMsg:null,force:!1};return s&&e.extend(n,s),e(this).data("jquery.shorten")&&!n.force?!1:(e(this).data("jquery.shorten",!0),e(t).off("click",".morelink"),e(t).on({click:function(){var s=e(this);return s.hasClass("less")?(s.removeClass("less"),s.html(n.moreText),s.parent().prev().prev().show(),s.parent().prev().hide(0,function(){n.onLess()})):(s.addClass("less"),s.html(n.lessText),s.parent().prev().prev().hide(),s.parent().prev().show(0,function(){n.onMore()})),!1}},".morelink"),this.each(function(){var s=e(this),t=s.html().trim(),r=t.length,o=t.substr(n.showChars,r-n.showChars).indexOf(" "),i=n.showChars+o;if(r>i+n.minHideChars){var l=t.substr(0,i);if(l.indexOf("<")>=0){for(var a=!1,h="",c=0,f=[],u=null,d=0,p=0;i>=p;d++){if("<"!=t[d]||a||(a=!0,u=t.substring(d+1,t.indexOf(">",d)),"/"==u[0]?u!="/"+f[0]?n.errMsg="ERROR en HTML: the top of the stack should be the tag that closes":f.shift():"br"!=u.toLowerCase()&&f.unshift(u)),a&&">"==t[d]&&(a=!1),a)h+=t.charAt(d);else if(i>=c)h+=t.charAt(d),c++;else if(f.length>0){for(j=0;j<f.length;j++)h+="</"+f[j]+">";break}p++}l=e("<div/>").html(h+'<span class="ellip">'+n.ellipsesText+"</span>").html()}else l+=n.ellipsesText;var m='<div class="shortcontent">'+l+'</div><div class="allcontent">'+t+'</div><span><a href="javascript://nop/" class="morelink">'+n.moreText+"</a></span>";s.html(m),s.find(".allcontent").hide(),e(".shortcontent > *:last",s).css("margin-bottom",0)}}))}});