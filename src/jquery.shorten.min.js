!function(a){"object"==typeof module&&"object"==typeof module.exports?a(require("jquery"),window,document):a(jQuery,window,document)}(function(a,b,c,d){a.fn.shorten=function(b){"use strict";var d={showChars:100,minHideChars:10,ellipsesText:"...",moreText:"more",lessText:"less",onLess:function(){},onMore:function(){},errMsg:null,force:!1};return b&&a.extend(d,b),!(a(this).data("jquery.shorten")&&!d.force)&&(a(this).data("jquery.shorten",!0),a(c).off("click",".morelink"),a(c).on({click:function(){var b=a(this);return b.hasClass("less")?(b.removeClass("less"),b.html(d.moreText),b.parent().prev().prev().show(),b.parent().prev().hide(0,function(){d.onLess()})):(b.addClass("less"),b.html(d.lessText),b.parent().prev().prev().hide(),b.parent().prev().show(0,function(){d.onMore()})),!1}},".morelink"),this.each(function(){var b=a(this),c=b.html().trim(),e=c.length,f=c.substr(d.showChars,e-d.showChars).indexOf(" "),g=d.showChars+f;if(e>g+d.minHideChars){var h=c.substr(0,g);if(h.indexOf("<")>=0){for(var i=!1,k="",l=0,m=[],n=null,o=0,p=0;p<=g;o++){if("<"!=c[o]||i||(i=!0,n=c.substring(o+1,c.indexOf(">",o)),"/"==n[0]?n!="/"+m[0]?d.errMsg="ERROR en HTML: the top of the stack should be the tag that closes":m.shift():"br"!=n.toLowerCase()&&m.unshift(n)),i&&">"==c[o]&&(i=!1),i)k+=c.charAt(o);else if(l<=g)k+=c.charAt(o),l++;else if(m.length>0){for(j=0;j<m.length;j++)k+="</"+m[j]+">";break}p++}h=a("<div/>").html(k+'<span class="ellip">'+d.ellipsesText+"</span>").html()}else h+=d.ellipsesText;var q='<div class="shortcontent">'+h+'</div><div class="allcontent">'+c+'</div><span><a href="javascript://nop/" class="morelink">'+d.moreText+"</a></span>";b.html(q),b.find(".allcontent").hide(),a(".shortcontent > *:last",b).css("margin-bottom",0)}}))},jQuery});